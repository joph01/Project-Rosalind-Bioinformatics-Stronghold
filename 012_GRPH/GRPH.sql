--Problem 12: Overlap Graphs
--Given: A collection of DNA strings in FASTA format having total length at most 10 kbp.
--Return: The adjacency list corresponding to O3. You may return edges in any order.

declare @input varchar(max) = 
'>Rosalind_3615
AGCCGGGCTACCAGCGGCCAGTCATGTTCAAATTATTATACTACAACAGCTACATATGTT
GAGTTGGTAGGCTGAGCAAATGATGTGATGACAGCA
>Rosalind_3324
GCCTTGCTGGGGTTTATCTCAGCCGCTCTAGGTCTATTCGATAAAAAGTAAAGCCCTAAT
TGTCGAACTGTCGATCATATAAG
>Rosalind_0698
ATCTTTTTCTTTGGAATTATATTCTCGGATGCACCCTACTGCCCGGCCGAATAATGATTG
ATAGAACGTTCATAACCTCGGTTTTT
>Rosalind_5190
GTAATGGAGACTACATAATCAGAGTTCAGCTGGACCGAAGGGGTATCCCTGGCTCCCTCC
CAGGGAACAATCACTTTGAATTAAACAGAATT
>Rosalind_5373
GATACCGCACGGGAAGACAGGAGGATAACTGGAAGTCATAGTCAGTCCCTGTAGTACTTA
CAGAGTCTTCCATAAAGAGTC
>Rosalind_8066
AGGCTATGTAGGAGTACCATGGTGCCGGGTCTTGCGCGCGTTGAACATGGTTGGCGATAC
GACGGCGACCTCGTAGTTTATCTCGGTAGCTCCGTAATC
>Rosalind_5864
GGATATCGTACTGTCACTCAAATCGCCTAGGGCCAGGGCGCGACCCCAGGTGCGGACCTC
TACCGATCGCAAATACATGCCTATTACCGCCTTGTT
>Rosalind_8068
CGGTCTAGTGGGTGCGTTTAGCCGGAATTGGATTTTCCCAGTACGGGAGAACCAAGACGT
AATTGTACGGCTAATTGTCCGAGGCTACCCGTAC
>Rosalind_4012
TGCGTGTGTTAGGCCGGTAACTACCCCTACTCTCAAATGTTTACGTATCGGCAAATACGC
TAGGCGCGTGACGGACGTGGACCGCCTTTCTACATTT
>Rosalind_1949
ACACTTACTCTGTTTAGGATATAGCAGCATGGAGACATTTGTCCATCTCAGGATCTCCTG
GCGCCGCGCCGATCGGTGCATCGGGTGTGACTAGTTCTG
>Rosalind_0799
AATTCATGACAGCCATGCCTCAACCGTTTCCCAACCAAGACACACTTCTCGAAGTGGCAT
CACGATTCGGTCGAGGTTCCTCCGTTTACATTCG
>Rosalind_9171
AATACCCGGTTACCACTGAGATATCTACAATGAGATAGAATAAAGCACTCTATATTCGGA
AATCAAGGGTCGGGCGGCCT
>Rosalind_8180
ACTTACTCCGCTGGGTCTAGGGATGCGGCTGTGTTCCGATCGAGCCGCGCGACTTAGGAA
CCACCGAGCTTAATTGAGCAGTAGGGGTAGGAAGCGCGA
>Rosalind_0378
AAAGTGCACGATGTACTCCGCACACACATGATAACCCGAAGGTTCTATCTAAAAATATTG
CCGGGTCCATCGAAAATATACTTTGGA
>Rosalind_9942
CAAGCAGCATCGGCCGACTGCCGGTACTATTTCAATGTCGCCACGGATTGACGAGCATAT
CATTTTAATCCTAACAGGATATGCATACGACCAGGCAA
>Rosalind_9034
GATCGCGACAATATAACACACAGTGGCTTGTGATTCATTGCGCGTGTTGTTCCGCTGGTT
TCACCACCGAAACAGCGTACACAGTGA
>Rosalind_4435
ACGCGCACACGCGAAAGGGATTAGGGAACTGGTTGCCTTGCTGCAGCTGTTACTAGCCTT
TGTGCTGAGAGGATACGCTTG
>Rosalind_1973
GAGAGCTACATTAAACTTGAAATCCTCGCATAAGTGATTAGGTTGACATGATCATTGCGT
GGATTTATGAATTGTCTAGAGGACT
>Rosalind_2049
CTTAGCCCCTGGGTCTCCTTTTAAAACCACGGAGGGGTTATGCCCGTAAGACGTGAGTCC
CCTCGGTCCATGTCAAACTTGAGTC
>Rosalind_3965
ATACAGTTCGCGCTTGGAGTCACGCACCACAGGGGCTGCCTCGGGCAGTTAAGCTGTGTT
TAGCTTCTGGGCTCGGTAGCTCAG
>Rosalind_2237
CCAGCTCTGAGGTAATTAAGTATACCCAGAGCTACCTAATCTTACTGATTTTGAAAGCTC
TCCTGCCCAATCATCTGTTCGCCATGGAATCTATAC
>Rosalind_9345
CCGAGTGGCTGGCGTTACATCGTGGCCTGGTAGCAGGGTGCGTGTCCAACAGTGAGCGCG
AAGTCCCGTTCAAAATCACGAT
>Rosalind_9767
GATAGGCTCCTGTTGTAACCGGTGTAGACTGCTATCAAGTCAGAAGATTTTATTCTCTGT
AATCCATGCAATGGCTGGAATAGTGTTGTT
>Rosalind_6083
GTATTGACCGGCTACGGTATGTACTAATGCGTGCGCCCTTGTTTCACGTATTTGTAAATA
TATGGGTGAATCTGTACGCTCACACT
>Rosalind_5160
CCATTAGCCAAGAAGTCCATCCACACCCACAATATCGGTGAAGGGGCAGGGCAGTGTACT
TTGCTAACTGCATTGCAATGCCGTGGG
>Rosalind_2471
CGAAAAGCTGGTCGTCAATACACCGCAGCAGAACTGATAGAGAATCAAAATTCTGCCTAC
AACGTCATCGGCTTGTTGCCTTGCC
>Rosalind_2916
GATCGCATTCGGGATTTTTGAATGGTGGTGGTGTGGTTTTATAAACGTTCCCCTGTTATG
GCGCCCGAGAAAGTCCCTAGTATGGAAGTCGGTATTGTT
>Rosalind_9496
AACGTCTTTGACGTACAAGCGAATCACCTATCGTGTGCATGTATATCTTAATACCACACA
CGACAGTAACGTAGTTTCGGCCAAGTCT
>Rosalind_4873
TTAGGCCCATGCGCCCGGGTTAACCACCATGACCTCGGCTAATCGAGACCTCCTTATGTC
AGATCGTTGTACAGGAACCGGGTCTTATGCCAA
>Rosalind_8587
AGAGTGATACCCCGCATTTTGCGCCCAAGGGGCTATATTCTCGATTCCACCAGTGGATAG
GAGAATATTGTCCTACGGGACTTA
>Rosalind_0122
TGCCCCCGGTTAGCGTTACCGGACTCTACATCGTAACCAGTATAGTATGGCATCAAACTA
GTGTATACCAGCTATTGCTT
>Rosalind_6541
GTTGGGTGGGTGGGTGAACAGGGTGATTAGAGGAGATGCCAGTATACCGTAATCGGACAT
ACGGGACGCCCGTGCATAGACGA
>Rosalind_9023
TAAAGGACACGTCGGTGAGGACTTCATGTCTTGCAAGTCATGTGTTATTTCCAGCTGTAT
GCTATGTTCGTCCACGCTCTGA
>Rosalind_3981
CCCCTGACCTTACACTTCCTACTTGGTGTTTTGAGAGAAGCAAGAAGCACCATGTGGACT
GGCAAGATTCGCTTAAACATGCTAAAG
>Rosalind_2248
ATTACCATCATGCGATACCCCGAAGAGGCTATGCGTATTTAGAGCATCTAGTAAATTGTG
GTTAACACAAAAAATACCGC
>Rosalind_4427
AATTTAAAATTCGGTGAGCATTTACCACCCGTAGCGAGTCACCTGGGACCAGTGAATTTC
CAACCGTATGGGTTACCAGGACCAATC
>Rosalind_5200
GTTAGTTAAGCCCTAATACCTCATCCCCTTCAGTGAACACAATGGGCATACTTGTAAACC
TGTAGTGACAGATAGTAACAGCCAACGCAA
>Rosalind_2479
GGAAGTACACAACGTCTGCTCTGCTTAAGTACCTGCCTGCTCGAGGACATGCAGCACTCC
CCGCCCAGTCGATGGGCATCGGAACGTACG
>Rosalind_6818
GCAATTCGTCCACTCAGCGGTCCTCTGCTAGCTTCCCCACTGGGTCTGAGAAATAAGATA
GACAGTAGCTCCATTTGCGCAATCTTAGTCTCTTT
>Rosalind_3543
AGCTAAACAATGGAGCTGAGGAGCAATTAACCTCTACGTATCCGGTCGTGTCTTCTTCAA
AGAAGATCCGATAAACTCCCAGTG
>Rosalind_1421
CAGTGGGATTATACACAGCGTAAAGTTGTATAGCATTCCGTTAACCAACGAACACTGGCG
GGTAGGACTGCCATTAGCTGGTCAT
>Rosalind_6632
CGCTTCCGTCTATCATGGCTAACACGCGGATACGTAGCTTAGCACGATACCGGTTATTGC
GCAGAATTTGCATGTTAATTGT
>Rosalind_9411
AACTTGGTCAAAGAAACTCTGGCATTAGCAATGCAGACGTAGGCCCTCTCGGATGGGGTG
CATCTCTAGTTTTGATCTGGTACC
>Rosalind_8895
CGTCCCAGATTTGAGACGGCACACGGGATGTACTGGAACTGTGCGATCCACTGGTCTTTT
CATCTTCATGCCGGCTGTGTCAGGATGCCACAGTCG
>Rosalind_8792
CACCCCTATGAAGAAGGCTGTTACGCGACGCCCCGACATTAAGCTTAGGGCGCAAGCATA
GACCCGCCCAGGGGTAAAGATAGACTACCGCAGTAGGCTT
>Rosalind_0860
GTTTATCAAGGGTATATCACATCGTAAGGTTTATTCGGAAGTTAGTGGGTGGCTACGGCC
AGACTCACTAGTCTGAGCTCTACTGAGTGAACTCTGTCTC
>Rosalind_3935
CCCGCATTTTAAGTTAGGAAGTTGATGTTGCCCCGAGTTGCTGGTTAGGGTGACTAAAAG
AAAACCGTCGCAGGCCGATCA
>Rosalind_4238
TGTTTCTTTGAGGTACGGCGGTGGCTTGTATAAGGGATTCATTAATTGGCCCCGCAGGCC
GTGCCTTTGCTATGGAAATTCGCATGCATC
>Rosalind_6549
ATAACGCCATGCATTTTTCAGTCAGTGTAAACTGACGGTCTCCGAGCTATCCGCGGTTTG
GTGGGTAGAAGCCAGTCTCATATT
>Rosalind_7188
CCGCATCGTAGATAGTTCGCTAGTCACTTCGCCCGAAGAACAACCCAACCCCGGGACACC
GGTCGCAACCGCAGCTCCCTGTTGGG
>Rosalind_1291
CCGCGGCACATGATCTTTCAACGGTTCGAGGTACGACTGCTATAAAAGACGCTTTTCAAA
CATTCTGGCAGACACGGGGCTCGATGA
>Rosalind_0789
CCAGCATAAGCAGACGACCGACAGGACGGTCCGCTAGTGTGGTGGTACGCCTAATTGTCT
TTTAGAGTGGATGCGAGTACACCCCGGGGGTATATATCAG
>Rosalind_9093
GGCTTAACAGGGCCTTCGGACGATGAGAGATGTAGTTTCTGGAAGACCAAGGCCGAGCGG
ATCCGTAGTCGACAGACAAGGGATCT
>Rosalind_1068
TAGCGCTCAAGTGCCGGGGCTCATAGCAGACCTGTTAGTCACTATTGAAACTCAAGCTAA
AAGCTACTAGCGACATGTAGATATGGCCTCTTCATAGC
>Rosalind_9913
TCACCGATGTCTTACTCCTTCGAGTGCAGCAGCTTTCCAAGATGCGAGTGTCAGTGACGA
CAGGACTCCGTAATGCGAGACGCACAACTGGAGCAGCGG
>Rosalind_5378
TGCCGCCTCATGTTGATTCATGGCGGCCTCTCAACTGAGGACACACAAGTGAATGGTATT
ACAATGCGGTCCGGCGTGCGCAAGTAGCATT
>Rosalind_0869
TCAAGCAGCGATTGTGTTATCAAGCAGGGGACCTTCACCTTTGTCAGGGCTTTCGAGGGT
AATTCATCAGAATCAGGGCTCATCATGTATGACGGG
>Rosalind_7961
CTCCACGGAACGAAGGGATTATTATGAATGATGGGTCTGATTCTGCAGGAGTATCTCATA
TGGATAGTGACTATGAGACGCCTC
>Rosalind_4979
TACGCCGGTCTCTCACGGAGTAGGAATCAAGGTAATGTAAGTGTGCCGACACCCCGTGCC
CCCTCTCACGATTTGAGAGATCAACACGGGTAGTTA
>Rosalind_3957
CCGCAGTCAAACAGCTGAAGCGTTACCGTATACAACTGTCTTGTGGCTCTGTGTAGGGAT
TTGCAGAAGGGCATCGATGACG
>Rosalind_5424
GTCTTTGAGCTCAAATTGCGGTCACATATTGCCGGACGTAGGCCAAGCTCGAGATCGAGC
GAATCCGTTCTTCTCGGCCACTT
>Rosalind_2202
GAACAGTCCTCCGAGAGTCACCTCGGCAGTCTAAGCCTGACTCTCTCAACATCGATCTCC
CCTAAGATGAATCAGGGACTCTTCCGTGGCTGTG
>Rosalind_0136
GCAAACCTATACTGAAACCACTGCAGGGTTGACCATAACAAAAGTACCACATGTACGTCT
TGTCGGCAAATCGTAAAGATCTTTTGCACTAACAAGGC
>Rosalind_9152
AGGCGGTGTTGTGCACCTGATATACAGTTCGAATGTCTTTGTGAAGGAGCACACGCGAGA
GTCGATTAGTTAGTGTAGCATAATCTACACGGCG
>Rosalind_6948
GGATTAGTCGACTAATAAGCAGACCGACTCGATGTATAGTAGGAAGAAAGTACCAGACTA
GCCAACTTCATATTCTATGATGTA
>Rosalind_4922
TTTGGTTACTTTACGTCAAGCGCGTGCATCAAGGGTCGAGATTACATCGTGCTTGGCGAG
CAGGGTCTTCAAAACAAAATTCTCGGGGATCCAT
>Rosalind_1116
ACCGCCGACTAACCCGAGGAAGCCTCCCAGTAGCCCCACGCACTCGTCAATTTCTCGTTG
GAGAAAGGGCCGGAGCTCATATTGAAGT
>Rosalind_5185
GGAGGCGAATTACACATACAAGTCTAGCTGTGGGATGCGTCTCGGCATGAGAAAGCTGCT
CGCCGTAATTTCTACGTGTGCAGTAT
>Rosalind_7692
ATGCGTTATAAACCCCTGGCCGTCTAAGGCAGGCCGGCGAAAGATACGTTCAGGTGCGGA
AGGATGAGGCCCTCTATAGT
>Rosalind_4565
ACTAACCCCTACTACTATAGGGAAGTCATACAGACGCCACAACCTTGAGTCGCAACGGTC
GGACCCTATTTGAGGGCAAGAAG
>Rosalind_4533
ACCAGTGTAGATCGTACCTGATCACCCCACCTTTCATTCCCACGTACGTAATATACAGGC
TAAGGCCCACGTAGTTCCATGTCGATCTCACGTGCTG
>Rosalind_2109
TCCACCCCTGCCCGATAACGATCACTCATCACCCCAACCTATGCCCCATCCTGACCTCTA
AGACCTGTTCCTGTGTTACAGTTG
>Rosalind_8814
AATGAGTCGTGTGACGCCCAACGTAGCTGCGCGACTTTCGCACAACATAGCGCGAATCCA
GAAGTTCGGACCGTCCATACTACTC
>Rosalind_0270
TTGTTAGGGGTTGTCACGGAGTAAAGATTCTTATGAGTGTGTAATTAATAACAGGATCAG
ACGCCTGACTTCCTCGCCAAAGTAGGTT
>Rosalind_7007
TGTTCGTAGTGGTACATCGAATTGCCTGGAAGAACATTATGCTCGATTTACTCGGTGCTC
CTTCAGCCACGCGTCAAGCATTGATGCTACTG
>Rosalind_3508
CCACTAATCCGATTATCAATGCGGCTCTTGACAAGGCACCCCAGCAAAGGTAACGGGTGA
GGCCACCTGTCAGTTCTTTTCGCTGGTGTCAATCCGCT
>Rosalind_1613
ATGCGACATATGGTGGGAAGCGGAGGTAAGCGTACTTAGGGGGAATATGAAAATATAAAA
ATATGAGAGCTAGGCCGCTTGTAATAAGTATTTCA
>Rosalind_2521
GGTGGTATATGTCCGCTGTTGATTATAGGGCCCTTGCCGTCTTCCCTCTTGATCACGTCG
TCTCAGCATTCCCTAGCGGTAAACG
>Rosalind_0053
AAGTCAAGGGGCGCTCATCTTAGCAAAATGTAAAGGCACCAAAATAACGACTTCAGCTGT
TTGAAACCATCACAAGGTAAGCCTAC
>Rosalind_2640
GCGTAGTGGTAGGGCTCCGTAATTGAAGCTAGTTTATTCTCATGTGGAGCACCGCATCGT
AGTATTAACAGCTACAGAGGGCAGAATGCCTGGCTCGG
>Rosalind_6276
TCCCGATTGTCTCGAAGTTGGACATGACAGCGGTCATCTGCAAATTTTTAGTTATGTAAA
ACGACCGGCGGGTTACCTGTAT
>Rosalind_3111
AGGAACCTTTACGCTCACATACCGTAAGCTAACGTGGTATGCGCTTAATACTGTTCCAGA
CGAGTTCCCAGTTGGCTGTAAGACGTATGTCA
>Rosalind_6337
CTCCGGTGGCTTGCGCTCCTAACATCCGTACCTTCTTTGAAGGCTCATCAATGGTTTATC
TGAAATGCGAGTACGACAGCTAGCGATATGGGCTAG
>Rosalind_7450
GACAAATCAAGCCTCCAAGACAAAGCTGAGTGATTAGTTTTTCGACCTATACGGTTGGAC
TGAAGACGTCTACCGTAGTGAGGA
>Rosalind_3143
TAGGCCCTCGACCGTCCCGCCGTACGAGTGCGTGCAGTGCAAATTGAAGTCACCACGCTA
TCGTCCTTCAAGCAACATTTCCGT
>Rosalind_1597
TAGGAAAGGTGGCCAAAATTGTTACAAGTCCCACCACGAAAACCTCACTACCCGCCGGGT
GGAAAATGCTAGAGTCGGGTCCGAACCC
>Rosalind_8055
GATGCGAGAAACTACCTGACGCTACTTACACTATTTGGCGCCACGTTTGGTCTATTTCGG
CGCGAAAACTTACCCTGAAGGGACAAATAA
>Rosalind_2038
ACGACGCAAGATCGTAAACCATCGATTGATGAGAAGTGACAAATGGTGCCCAAAGGGCCG
AAATGTAGTGGACCCAGCTCACATGTGTTGACACCCC
>Rosalind_0479
GGTTCTAAATACATGGACTGGAGTGCCAGTACCTTTGGAATGACACCGTCTTTCACTCAA
CGCCTCGCAAGACGGGTGTCAAATAGGCGC
>Rosalind_9003
TGCAGATCCAAAGTAAGGTCATCTCCGCACAACAACACAGCCCTCTGATTTATTTTGGGT
ATAGGCGCAGCGGGCCGCTAAGCACCATCC
>Rosalind_8091
GTCTGTTTTCTCCCGGTGGTGTGGGCAATAGAGAGCCTATAGAAGGACACTATAGGTTGG
CTTTAGGGCCGGGTCTGTGTAATGGTGTCGCTGTGA
>Rosalind_1448
GAACCGAGTCCATAGGAAATTGTGGTTGCTCCTTTCTTAGCAAAATGTCACAGTAAATGG
GACAGGGCGTTTGCCAGTACCCCGTCCCGTGTTCTGTCT
>Rosalind_7023
TATTGTTGAGTTCAATACTTCGATCTACAGCAGCGTGGTCCTCAAAAATTTGCTAGTAAT
ACAACAGGAGATAGCGGTGCCCGGAA
>Rosalind_0622
CCGTCGAGCATCTCCCAACGTGCCTGCCCTGGTGTTTCAGTGAAGGTCTGGAAAGCACCT
ATGAATGTGTCCCGTTTACTGGTTG
>Rosalind_0222
TATTAGGCAAAGCACCATAATCCTGGACTGAATAGATGATCAGCAAAGTAGGATATGGGT
CTGCCAAGAGGGCCTTGGCCC
>Rosalind_6724
CGTACAGGGCCCCGTTCGTCCGGGTTAGTCTCAAGAGGGGGGCTTATATAATGCTGCGGG
TCATTCGGGGCCTCCCCGTACCCTCAGATGC
>Rosalind_8747
ATGGCAAAGCCGGAGTCATGCTGCTGGGAGAGACATACCGTGGTCGAACCAATCGTATAT
TGGTAACCCAACTTGTCTACTGG
>Rosalind_6410
TAGCTACGTATCATTATAGGCCACCCCCTGTCGTCGTCGCGCAATCCCCCGCCAAGCCAG
CTGCTTGCGACCCGGTTTACACGGCTTGCCCGTCA
>Rosalind_8785
CTTCGGGATACGGTCCTTGCAAGCTAGCTTCCGGACAGTGCCTCAGGCTAGAACATCACT
TACCGAGACTTTTAGCTGGACATC
>Rosalind_0490
TGCATACAACCATTGGTCCTACCACCCAAACCGTACTGGATCAATTCCCACACGCGACTG
TTGATATTGCACCAGCTTCGTAGTCAAACTGCCCTT';

declare @overlap int = 3;

set @input = @input + '>';

with

parsed_input as
(
select 0 as num, left(@input, CHARINDEX('>', @input) - 1) as string, stuff(@input, 1, CHARINDEX('>', @input), '') as leftover
union all select num + 1, left(leftover, CHARINDEX('>', leftover) - 1),  stuff(leftover, 1, CHARINDEX('>', leftover), '') from parsed_input where CHARINDEX('>', leftover) > 0
),

input as 
(
select 
left(string, CHARINDEX(char(13), string) - 1) as name, replace(replace(stuff(string, 1, CHARINDEX(char(13), string) + 1, ''), char(13), ''), char(10), '') as string 
from parsed_input 
where
1=1
and ltrim(rtrim(string)) <> ''
)

select i1.name + ' ' + i2.name
from input i1
cross join input i2
where 
right(i1.string, @overlap) = left(i2.string, @overlap)
and i1.name <> i2.name
order by i1.name

option (maxrecursion 0)
